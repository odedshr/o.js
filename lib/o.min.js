ã€‡=O=function(){function e(e,t){this.message=e,this.stack=t}return this.VER={framework:"0.1.2"},this.isNodeJS="undefined"==typeof window,e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,this.isNodeJS||(this.COOKIE=function(){var e=function(e,t,n){if(void 0!==t){void 0===n&&(n=0);var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var r="expires="+i.toUTCString();return document.cookie=e+"="+t+"; "+r,this}return document.cookie.replace(new RegExp("(?:(?:^|.*;\\s*)"+e+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1")}.bind(this);return e}.call(this),this.EVT=function(){var e={},t=window.onload?window.onload:!1,n=function(e,t){return document.dispatchEvent(new CustomEvent(e,{detail:t}))},i=function(e,t){return"function"==typeof t&&r(e,t),function(t){return n(e,t)}},r=function(e,t){return document.addEventListener(e,t),this},o=function(e,t){return document.removeEventListener(e,t),this};return e.subscribe=r.bind(e),e.unsubscribe=o.bind(e),e.dispatch=n.bind(e),e.getDispatcher=i.bind(e),window.onload=e.getDispatcher("window.onload"),t&&e.subscribe("window.onload",t),e}.call(this),this.ELM=function(){var e={},t=function(){var e=this;for(var t in this)this.hasOwnProperty(t)&&"function"!=typeof this[t]&&delete this[t];return[].forEach.call(document.querySelectorAll("[id]"),function(t){e[t.id]=t}),this}.bind(e),n=new MutationObserver(t.bind(e)),i={childList:!0,subtree:!0,attributes:!1,characterData:!1,attributeOldValue:!1,characterDataOldValue:!1},r=function(e){return e?(n.observe(document.body,i),t()):n.disconnect(),this}.bind(e),o=function(e){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var i=0;i<this.length;i++)t[0]=this[i],e.apply(this,t);return this},s=function(e){var t=document.querySelectorAll(e);return t.each=o.bind(t),t.remove=o.bind(t,this.DOM.remove),t.useAsTemplate=o.bind(t,this.TPL.use),t.html=o.bind(t,function(e,t){e.innerHTML=t}),t.css={add:o.bind(t,this.CSS.add),remove:o.bind(t,this.CSS.remove),toggle:o.bind(t,this.CSS.toggle)},t}.bind(this);return e.refresh=t,e.per=s.bind(e),e.observe=r,this.EVT.subscribe("window.onload",function(){r(!0)}.bind(this)),e}.call(this),this.DOM=function(){var e={},t=function(e,t,n){var i=document.createElement(e);return t&&Object.keys(t).forEach(function(e){i.setAttribute(e,t[e])}),n&&(i.innerHTML=n),i},n=new DOMParser,i=function(e){return n.parseFromString(e.trim(),"text/html").body.firstChild},r=function(e){return"string"==typeof e?i(e):e},o=function(e,t){return e.parentNode.insertBefore(r(t),e),this},s=function(e,t){return e.parentNode.insertBefore(r(t),e.nextSibling),this},a=function(e,t){return e.insertBefore(r(t),e.firstChild),this},d=function(e,t){return e.appendChild(r(t)),this},u=function(e){if("object"!=typeof e)throw"bad input for DOM.remove function ("+e+")";if(!e.parentNode||!e.removeChild)throw"cannot remove child without a parentNode";e.parentNode.removeChild(e)};return e.create=t.bind(e),e.parse=i.bind(e),e.insertBefore=o.bind(e),e.insertAfter=s.bind(e),e.prepend=a.bind(e),e.append=d.bind(e),e.remove=u.bind(e),e}.call(this),this.CSS=function(){var e={},t="js-",n=!0,i=function(){return n?t:""},r=function(e,t){return e&&e.className.split(" ").indexOf(i()+t)>-1},o=function(e,t,n,r){var o=e.className.split(" "),s=-1!=o.indexOf(i()+t);return s?(r||!n&&!r)&&o.splice(o.indexOf(i()+t),1):(n||!n&&!r)&&o.push(i()+t),e.className=o.join(" "),this},s=function(e,t){var n=e.className.split(" ");return-1==n.indexOf(i()+t)&&n.push(i()+t),e.className=n.join(" "),this},a=function(e,t){var n=e.className.split(" ");return-1!=n.indexOf(i()+t)&&n.splice(n.indexOf(i()+t),1),e.className=n.join(" "),this};return e.has=r.bind(e),e.add=s.bind(e),e.remove=a.bind(e),e.toggle=o.bind(e),e.toggle=o.bind(e),e.isJsPrefixed=function(e){return"undefined"!=typeof e&&(n=e),n},e}.call(this),this.AJAX=function(){function t(t,n,i,r){var o=new e(r,{});o.status=n.status,o.url=n.responseURL,o.data=i,t(o)}var n={},i={credentials:!1,type:"json",url:!1,callback:!1},r=function(e,n,r,o,s){if(["GET","DELETE"].indexOf(e)>-1&&(s=o,o=r,r=void 0),"undefined"==typeof n){if(!i.url)throw new Error("missing-url");n=i.url}s=s||{},void 0===s.credentials&&(s.credentials=i.credentials),void 0===s.type&&(s.type=i.type);var a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return a.onload=function(){a.readyState==XMLHttpRequest.DONE&&(4==+a.readyState&&200==+a.status?o?o(a.response):i.callback&&i.callback(a.response):t(o,a,r,a.statusText))},a.onerror=t.bind(this,o,a,r),a.withCredentials=void 0!==s.credentials,a.open(e,encodeURI(n),!0),s.credentials&&a.setRequestHeader("Authorization",s.credentials),s.type&&(a.responseType=s.type),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.send(r?JSON.stringify(r):!1),a},o=function(e){for(var t in e)i.hasOwnProperty(t)&&(i[t]=e[t])};return n.get=r.bind(n,"GET"),n.post=r.bind(n,"POST"),n.put=r.bind(n,"PUT"),n["delete"]=r.bind(n,"DELETE"),n.setDefaults=o.bind(n),n}.call(this)),this.TPL=function(){var e=function(){return this.isNodeJS?"en-us":(window.navigator.userLanguage||window.navigator.language).toLowerCase()}.bind(this),t=e(),n={};n[t]={};var i,r,o,s,a,d,u,c={},l={},f=[{start:"{{",end:"}}"}],h=function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/gm,"\\$&")},p=function(e,t){i=new RegExp(e+"([^#]+?)"+t,"g"),r=new RegExp(e+"#(.+?)"+t,"g"),o=new RegExp(e+"\\?(.+?)"+t+"([\\s\\S]+?)"+e+"[\\/$]\\1"+t,"g"),s=new RegExp(e+"\\?\\!(.+?)"+t+"([\\s\\S]+?)"+e+"\\/\\1"+t,"g"),a=new RegExp(e+"([^@}]+?)@([\\s\\S]+?)(:([\\s\\S]+?))?"+t+"([\\s\\S]+?)"+e+"\\/\\1@\\2"+t,"g"),d=new RegExp(e+"\\@([\\s\\S]+?)"+t+"([\\s\\S]+?)"+e+"\\/\\1"+t,"g"),u=new RegExp(e+"'([^'}]+?)','([\\s\\S]+?)'"+t+"([\\s\\S]+?)"+e+"\\/'\\1','\\2'"+t,"g"),quotePattern=new RegExp("^'.*'$")}.bind(this),b=new RegExp('<template data-id="([\\s\\S]+?)">([\\s\\S]+?)</template>',"g"),g=function(e,t){if(void 0===t&&"string"!=typeof e&&(t=e.getAttribute("data-template"),void 0===t&&(t=e.getAttribute("data-id")),void 0===t&&(t=e.getAttribute("id"))),!t)throw new Error("could not determine id for template "+e);return l[t]="string"==typeof e?e:e.innerHTML?e.innerHTML:e.html(),this}.bind(c),v=function(){return Object.keys(l)},w=function(e){return this.AJAX.get(e,function(e){for(var t;null!==(t=b.exec(e));)g(t[2],t[1]);this.EVT.dispatch("TPL.templatesLoaded",v())}.bind(this),{type:"text"}),this}.bind(this),m=function(e){return this.isNodeJS?y(require(e)):this.AJAX.get(e,y,{type:"json"}),this}.bind(this),y=function(e){for(var t in e)e.hasOwnProperty(t)&&x(t,e[t]);this.isNodeJS||this.EVT.dispatch("TPL.languageLoaded",Object.keys(e))}.bind(this),x=function(e,t){"undefined"==typeof n[e]&&(n[e]={});for(var i in t)t.hasOwnProperty(i)&&(n[e][i]=t[i]);return this},E=function(n){return t=n?n:e(),this},O=function(){return t},S=function(e,t){var n=!1,i=t.split(":"),r=i[1];if(t=i[0],"."===t)n=e;else{var o=t.split(".");if(o.length>1){n=e.hasOwnProperty(o[0])?e[o[0]]:o[0];for(var s=1;s<o.length;s++)n=n.hasOwnProperty(o[s])?n[o[s]]:o[s]}else n=e.hasOwnProperty(t)?e[t]:"."===t?e:t}if(r){var a={};return r=r.match(quotePattern)?r.replace(/'/g,""):S(e,r),a[r]=n,j(a)}return n},T=function(e){return"function"==typeof e?e():"object"==typeof e?JSON.stringify(e):e},L=function(e){var i=n[t][e];return T("undefined"!=typeof i?i:e.substr(e.indexOf(".")+1))},j=function(e){if(1!==Object.keys(e).length)throw new Error("cannot render multiple templates!");var t=Object.keys(e)[0];if(void 0===l[t])throw new Error("template not found:"+t);return N(l[t],e[t])},N=function(e,t){for(var n;null!==(n=u.exec(e));){var c={start:h(n[1]),end:h(n[2])};f.push(c),p(c.start,c.end),e=e.split(n[0]).join(N(n[3],t)),f.pop();var l=f[f.length-1];p(l.start,l.end),u.lastIndex=0,u.lastIndex=0}for(;null!==(n=d.exec(e));)e=e.split(n[0]).join(N(n[2],S(t,n[1]))),d.lastIndex=0;for(;null!==(n=a.exec(e));){var b=[],g=S(t,n[2])[n[1]];if(void 0!==g){for(var v=g.length,w=0;v>w;w++){var m=g[w];"object"==typeof m&&"undefined"!=typeof n[4]&&(m[n[4]]=w),b[w]=N(n[5],m)}e=e.split(n[0]).join(b.join(""))}else e=e.split(n[0]).join("");a.lastIndex=0}for(;null!==(n=s.exec(e));)e=e.split(n[0]).join(S(t,n[1])===!1?n[2]:""),s.lastIndex=0;for(;null!==(n=o.exec(e));)e=e.split(n[0]).join(S(t,n[1])===!0?n[2]:""),o.lastIndex=0;for(;null!==(n=i.exec(e));)e=e.split(n[0]).join(T(S(t,n[1]))),i.lastIndex=0;for(;null!==(n=r.exec(e));)e=e.split(n[0]).join(L(n[1])),r.lastIndex=0;return e};return p(f[0].start,f[0].end),c.load=w.bind(c),c.use=g,c.loadLanguage=m.bind(c),c.appendToLanguage=x.bind(c),c.setLocale=E.bind(c),c.getLocale=O.bind(c),c.translate=L.bind(c),c.list=v.bind(c),c.render=this.isNodeJS?N.bind(c):j.bind(c),this.isNodeJS?module.exports=c:this.EVT.subscribe("window.onload",function(){this.ELM.per('[data-template]:not([data-template=""]').useAsTemplate()}.bind(this)),c}.call(this),this}.call("undefined"!=typeof O?O:{});
